<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bean & Byte</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            background: #0f172a;
            color: white;
            font-family: Arial;
        }

        .card {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            overflow: hidden;
            transition: 0.4s;
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 0 25px #00ffe0;
        }

        .btn {
            background: #00ffe0;
            color: black;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: bold;
            transition: 0.3s;
        }

        .btn:hover {
            transform: scale(1.05);
        }
    </style>
</head>

<body>

<!-- NAVBAR -->
<nav class="bg-[#064e3b] p-5 flex justify-between items-center shadow-lg">

    <a href="/" class="text-2xl font-bold text-[#00ffe0]">
        Bean & Byte
    </a>

    <!-- CART BUTTON -->
    <button onclick="toggleCart()" 
            class="relative text-white hover:text-[#00ffe0]">

        ðŸ›’

        <span id="cartCount"
              class="absolute -top-2 -right-3 
                     bg-red-500 text-xs 
                     px-2 py-1 rounded-full">
            0
        </span>

    </button>

</nav>

<div class="h-6"></div>

{% block content %}
{% endblock %}

<!-- CART SIDEBAR -->
<div id="cartSidebar"
     class="fixed top-0 right-0 w-96 h-full 
            bg-[#111827] shadow-2xl 
            transform translate-x-full
            transition-transform duration-300
            z-50 p-6 overflow-y-auto">

    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold text-[#00ffe0]">
            Your Cart
        </h2>
        <button onclick="toggleCart()" class="text-white text-xl">
            âœ•
        </button>
    </div>

    <div id="cartItems" class="space-y-4 text-gray-300"></div>

    <div class="border-t border-gray-600 mt-6 pt-4">
        <h3 class="text-lg font-semibold">
            Total: â‚¹<span id="cartTotal">0</span>
        </h3>
    </div>

</div>

<script>

/* ================= GLOBAL CART ================= */

let cart = JSON.parse(localStorage.getItem("cart")) || [];

/* ================= TOGGLE ================= */

window.toggleCart = function() {
    document.getElementById("cartSidebar")
            .classList.toggle("translate-x-full");
};

/* ================= ADD TO CART ================= */

function addToCart(name, price) {

    price = parseInt(price);

    const existing = cart.find(item => item.name === name);

    if (existing) {
        existing.quantity += 1;
    } else {
        cart.push({
            name: name,
            price: price,
            quantity: 1
        });
    }

    saveCart();
    updateCart();
}

/* ================= AUTO BUTTON LISTENER ================= */

document.addEventListener("click", function(e) {

    if (e.target.classList.contains("add-to-cart")) {

        const name = e.target.dataset.name;
        const price = parseInt(e.target.dataset.price);

        addToCart(name, price);
    }

});

/* ================= SAVE ================= */

function saveCart() {
    localStorage.setItem("cart", JSON.stringify(cart));
}

/* ================= UPDATE UI ================= */

function updateCart() {

    const cartContainer = document.getElementById("cartItems");
    const totalElement = document.getElementById("cartTotal");
    const cartCount = document.getElementById("cartCount");

    cartContainer.innerHTML = "";

    let total = 0;
    let totalItems = 0;

    cart.forEach(item => {

        total += item.price * item.quantity;
        totalItems += item.quantity;

        const div = document.createElement("div");
        div.className = "bg-[#1f2937] p-3 rounded-lg flex justify-between";

        div.innerHTML = `
            <div>
                <p class="font-semibold">${item.name}</p>
                <p class="text-sm text-gray-400">
                    â‚¹${item.price} Ã— ${item.quantity}
                </p>
            </div>
            <span class="font-semibold">
                â‚¹${item.price * item.quantity}
            </span>
        `;

        cartContainer.appendChild(div);
    });

    totalElement.textContent = total;
    cartCount.textContent = totalItems;
}

document.addEventListener("DOMContentLoaded", updateCart);

</script>

</body>
</html>
